<div class="container-fluid">
  <div class="row">

    <div class="col-12 col-md-4">
      <form (ngSubmit)="onSubmitImportForm()">
        <div class="bg-light">
          <label for="labelWinners" class="form-label">
            <h4>DÃ©but de pÃ©riode : </h4>
          </label>
          <div class=" d-flex justify-content-between">
            <input type="date" required name="startOfPeriod" id="startOfPeriodId" [(ngModel)]="importDate" />
            <button class="btn btn-warning" (click)="onSubmitTestImportForm()">Exemple</button>
          </div>
        </div>
        <br>
        <textarea required name="importDatas" id="importDatasId" class="form-control bg-light"
          placeholder="Copier le fil cagnotte ici !" rows="16" [(ngModel)]="importDatas"></textarea>

        <br><br>

        <div class="d-grid">
          <button class="btn btn-danger" type="submit" [disabled]="!importDatas || !importDate">
            <h5>Extraire les donnÃ©es !</h5>
          </button>
        </div>

      </form>

    </div>


    <div class="col-12 col-md-4" *ngIf="participantsList">
      <form #paramsForm="ngForm" (ngSubmit)="onSubmitConfigForm(paramsForm.value)">
        <div class="bg-success p-2 text-dark bg-opacity-10">
          <label for="labelWinners" class="form-label">
            <h4>Gagnants : </h4>
          </label>
          <select required name="winnerGold" class="form-select" ngModel>
            <option value="">Choisissez le gagnant ğŸğŸğŸ</option>
            <option *ngFor="let participant of participantsList" value="{{ participant.name }}">
              {{ participant.name }}
            </option>
          </select>

          <select required name="winnerSilver" class="form-select" ngModel>
            <option value="">Choisissez le gagnant ğŸğŸ</option>
            <option *ngFor="let participant of participantsList" value="{{ participant.name }}">
              {{ participant.name }}
            </option>
          </select>

          <select required name="winnerBronze" class="form-select" ngModel>
            <option value="">Choisissez le gagnant ğŸ</option>
            <option *ngFor="let participant of participantsList" value="{{ participant.name }}">
              {{ participant.name }}
            </option>
          </select>

        </div>

        <br><br>

        <div class="bg-warning p-2 text-dark bg-opacity-10">
          <label for="labelWinners" class="form-label">
            <h4>RÃ©partiteur : </h4>
          </label>
          <select required name="dispatcher" class="form-select" ngModel>
            <option value="">--Choisissez le rÃ©partiteur--</option>
            <option *ngFor="let participant of participantsList" value="{{ participant.name }}">
              {{ participant.name }}
            </option>
          </select>
        </div>

        <br><br>

        <div class="d-grid">
          <button class="btn btn-danger" type="submit" [disabled]="!paramsForm.form.valid">
            <h5>Lancer la rÃ©partition !</h5>
          </button>
        </div>


      </form>
    </div>

    <div class="col-12 col-md-4" *ngIf="participantsList">
      <table class="table table-striped table-hover">
        <thead>
          <tr class="table-primary">
            <th scope="col">NÂ°</th>
            <th scope="col">Donateur</th>
            <th scope="col">Pfs</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="
              let participant of participantsList;
              let indexOfelement = index
            ">
            <td>
              <h6 class="card-title">{{ indexOfelement + 1 }}</h6>
            </td>
            <td>
              <h6 class="card-text">{{ participant.name }}</h6>
            </td>
            <td>
              <h6 class="card-title">{{ participant.donation }}</h6>
            </td>
            <td *ngIf="participant.isAuto" class="badge text-bg-primary">
              auto
            </td>
          </tr>
        </tbody>
        <thead>
          <tr class="table-primary">
            <th scope="col"></th>
            <th scope="col"></th>
            <th scope="col">{{ totalJackpot }}</th>
          </tr>
        </thead>
      </table>
    </div>
  </div>



  <!-- ********************************************************************************************************************* -->

  <div *ngIf="repartitionsList">
    <div class="bg-success p-2 text-dark bg-opacity-10">
      <h4 class="shadow p-3 mb-5 bg-body rounded">Guilde : ğŸŒœCALADAN ğŸŒ›</h4>
      <div class="content" appCopyToClipboard appShadowContainer>
        Le calcul de la rÃ©partition des gains a Ã©tÃ© effectuÃ©, merci aux participants
        ! Vous trouverez votre propre fil en social, reprenant la rÃ©partition des
        gains.<br />
        <div *ngFor="let winner of winnersList; let indexOfelement = index">
          <br />
          {{ indexOfelement + 1 }}. RÃ©partition cagnotte ğŸ¥‡ğŸ¥ˆğŸ¥‰ {{ winner.name }} -
          {{ jackpotList[indexOfelement] }} pfs<br />
          <span *ngFor="let repartition of repartitionsList[indexOfelement]">{{ repartition.name }}, </span><br />
        </div>
        <br />
        Vous pouvez vÃ©rifier que vous y avez bien accÃ¨s et ainsi vous acquitter de
        votre don.
      </div>
    </div>
  </div>
  <br>

  <!-- ********************************************************************************************************************* -->

  <div *ngIf="repartitionsList">
    <div class="bg-warning p-2 text-dark bg-opacity-10">
      <h4 class="shadow p-3 mb-5 bg-body rounded">Social</h4>
      <div *ngFor="let winner of winnersList; let indexOfelement = index">
        <h5 class="shadow p-3" appCopyToClipboard appShadowContainer>
          RÃ©partition cagnotte ğŸ¥‡ğŸ¥ˆğŸ¥‰ {{ winner.name }}
        </h5>
        <br>
        <div class="content" appCopyToClipboard appShadowContainer>
          Bonsoir Ã  toutes et Ã  tous,<br /><br />
          VoilÃ  le fil pour l'attribution de la rÃ©compense au
          {{ indexOfelement + 1 }}Â° gagnant : {{ winner.name }}, pour la pÃ©riode
          du {{ importDate | customPeriod: 0 }}.<br />
          Merci Ã  {{ winner.name }} de lier un GM sur ce fil (avec un niveau
          vierge et ouvert pour faciliter le suivi) afin que les dons puissent
          Ãªtre dÃ©posÃ©s.<br /><br />
          Ps: comme câ€™est un don, merci de reverser le bÃ©nÃ©fice sur le mÃªme gm
          dans le cas oÃ¹ vous prenez une place qui vous rapporte des pfs. Je
          compte sur votre honnÃªtetÃ© !
  
          Doivent dÃ©poser sur le gm de {{ winner.name }} âš  mettre nom GM âš  :
          (copier/coller message et indiquer "fait")<br />
          <div *ngFor="let repartition of repartitionsList[indexOfelement]">
            {{ repartition.name }} {{ repartition.donation }}
          </div>
        </div>
        <br> <br>
      </div>
    </div>
  </div>
  <br>
  
  <!-- *********************************************************************************************************************-->
  
  <div *ngIf="repartitionsList">
    <div class="bg-danger p-2 text-dark bg-opacity-10">
      <h4 class="shadow p-3 mb-5 bg-body rounded">Social</h4>
      <h5 class="shadow p-3" appCopyToClipboard appShadowContainer>
        ğŸ¥‡Cagnotte pÃ©riode du {{ importDate | customPeriod: 1 }}
      </h5>
      <br>
      <div class="content" appCopyToClipboard appShadowContainer>
        Tous les 15 jours, nous rÃ©compensons les 3 joueurs qui ont eu la meilleure
        progression.<br />
        Comment ?<br />
        Toutes les 2 semaines, nous ouvrons une cagnotte et chaque chaque joueur
        pourra y souscrire en Ã©crivant son nom et le nombre de PFS quâ€™il souhaite
        donner. Ce don nâ€™est absolument pas obligatoire ! Sachez nÃ©anmoins que si
        vous etes dans le top 3 des meilleures progressions, vous ne pourrez pas
        remporter la cagnotte si vous n'y participez pas. ğŸ˜Š<br />
        <br />
        Le total de ces promesses constitueront donc la cagnotte qui sera rÃ©partie
        entre les trois vainqueurs de la faÃ§on suivante :<br />
        P1 : 50% des dons ğŸğŸğŸ<br />
        P2 : 30% des donsğŸğŸ<br />
        P3 : 20% des donsğŸ<br />
        <br />
        Les gagnants pourront alors indiquer sur quel GM ils souhaitent que la
        rÃ©compense soit dÃ©posÃ©e. Pas dâ€™inquiÃ©tude ! pas de calcul de rÃ©partition
        ou de pourcentage Ã  faire ! Jâ€™indiquerai Ã  chacun Ã  qui il doit donner ses
        PFS afin que chaque gagnant touche le bon montant de la rÃ©compense ğŸ˜Š<br />
        <br />
        Donc il est donc important dâ€™attendre mes indications avant de dÃ©poser les
        PF, sinon il nous sera impossible dâ€™obtenir la rÃ©partition 50, 30, 20 !<br />
        <br />
        Il sera impossible de gagner deux fois dâ€™affiliÃ©es :<br />
        Exemple:<br />
        Si vous Ãªtes 3iÃ¨me en pÃ©riode 1<br />
        Et 3iÃ¨me en pÃ©riode 2.<br />
        Vous ne toucherez pas de rÃ©compense en pÃ©riode 2. Celle ci sera attribuÃ©e
        au 4iÃ¨me.<br />
        <br />
        Autre exemple:<br />
        Vous Ãªtes 3iÃ¨me la pÃ©riode 1, premier la pÃ©riode 2, ==> Vous ne toucherez
        pas de rÃ©compenses en pÃ©riode 2 non plus.<br />
        <br />
        Tout redevient normal en pÃ©riode 3, vous pouvez de nouveau gagner la
        rÃ©compense<br />
        <br />
        Pour info, les membres du conseil de Caladan renoncent Ã  leur droit de
        gagner la cagnotte. ğŸ˜‰
      </div>
    </div>
  </div>
  <br>

  <!-- ********************************************************************************************************************* -->

  <div *ngIf="repartitionsList">
    <div class="bg-danger p-2 text-dark bg-opacity-10">
      <div class="content" appCopyToClipboard appShadowContainer>
        Cagnotte pour la pÃ©riode du {{ importDate | customPeriod: 1 }} (
        <span *ngFor="let winner of winnersList">{{ winner.name }}, </span>
        ) ne sont pas Ã©ligibles aux gains mais rien ne les empÃªche d'Ãªtre dans le
        top 3 quand mÃªme ;) )<br />
        Promesses de dons (Nom suivi de pf, suivi de '(auto)' si vous voulez un
        report automatique):<br />
        <div *ngFor="let participant of participantsList">
          <div *ngIf="participant.isAuto">
            {{ participant.name }} {{ participant.donation }} (auto)
          </div>
        </div>
      </div>
    </div>
  </div>
  </div>